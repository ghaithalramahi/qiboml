from qiboml import ndarray
from qiboml.models.abstract import QuantumCircuitLayer

def _run_layers(x: ndarray, layers: list[QuantumCircuitLayer], parameters):
    index = 0
    params = []
    for layer in layers[:-1]:
        if layer.__class__.__name__ == "PhaseEncodinglayer":
            params += [param for param in x]
        #    layer.parameters = parameters[index]
        #    index += 1
        x = layer.forward(x)
    breakpoint()
    x.set_parameters(params + [par for parameter in parameters for par in parameter])
    return layers[-1].forward(x)
